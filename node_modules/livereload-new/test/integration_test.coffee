sinon = require 'sinon'
createService = require '../lib/endpoint'
soa = require 'livereload-soa'

describe "LiveReload backend", ->

  beforeEach -> @carrier = new soa.StubCarrier(); sinon.spy(@carrier, 'send')
  beforeEach -> @service = createService(@carrier)
  afterEach (done) -> @service?.dispose(done)

  it "sends 'hello' immediately after creation", ->
    sinon.assert.calledWith(@carrier.send, { command: 'hello', services: ['dummy', 'server', 'reloader'] })
