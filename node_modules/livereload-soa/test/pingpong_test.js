var assert = require('assert');
var createPingPong = require('../example/pingpong');

describe("PingPong service", function() {
  it("sends HELLO command on start with a list of provided services", function(done) {
    var events = [];
    var carrier = { send: function(message) { events.push(message); }, pipe: function() { return this; }};
    var service = createPingPong(carrier);

    setTimeout(function() {
      assert.deepEqual(events, [{ command: 'hello', services: ['pingpong'] }]);
      done();
    }, 5);
  });
});
